<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Manage Photos</title>
        <link rel="stylesheet" href="assets/css/app.css">
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
    </head>
    <body>
        <h1 class="title">Manage Photos</h1>

        <h3 class="title">Rename photos of a folder</h3>
        <form class="form" action="#">
            <!--<input id="photos-folder-txt" type="text" name="photos_folder" placeholder="Photos folder..." />-->
            <label class="custom-file-upload">
                <input id="photos-folder" type="file" webkitdirectory />
                <i class="fa fa-folder-open"></i> Select folder
            </label>
            <label>
                <input type="checkbox" id="do-rename" name="do-rename" value="1" /> Do rename
            </label>
            <br /><br />
            <!--<button class="btn" type="submit">Rename!</button>-->
        </form>
        <hr />
        <section id="files">
          <h4 class="title"></h4>
        </section>

        <footer>
            <!-- All of the Node.js APIs are available in this renderer process. -->
            <p>
                Node.js <script>document.write(process.versions.node)</script> |
                Chromium <script>document.write(process.versions.chrome)</script> |
                Electron <script>document.write(process.versions.electron)</script>
            </p>
            <p>&copy; 2015 - csd</p>
        </footer>
  </body>
  <script>window.$ = window.jQuery = require('jquery');</script>
  <script>

      let $pf = $('#photos-folder');
      $pf.on('change', (e) => {
          let selectedFolder = getFolder($pf);

          // send event to main window
          if(selectedFolder){
              const {ipcRenderer} = require('electron');
              let params = {'folder': selectedFolder, 'doRename': $('#do-rename').is(':checked')};
              console.log('send event to main window', params);
              ipcRenderer.send('ri-folder-selected', params);
          }
      });


      /**
       * Get selected folder
       * @param $folderInput
       * @returns promise
       */
      function getFolder($folderInput)
      {
          let pfFiles = $folderInput.prop('files');
          if(pfFiles.length > 0) {
              return pfFiles[0].path;
          }
          return null;
      }

  </script>
</html>
